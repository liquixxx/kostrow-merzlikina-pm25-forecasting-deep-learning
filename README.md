Прогнозирование уровня загрязнения воздуха (PM2.5) с помощью полносвязной нейронной сети на TensorFlow

Введение

Загрязнение атмосферного воздуха является одной из наиболее острых экологических проблем современности. Высокие концентрации мелкодисперсных частиц PM2.5 (диаметр ≤ 2.5 мкм) напрямую связаны с ростом заболеваемости дыхательных и сердечно-сосудистых систем и увеличением смертности населения.

В крупных мегаполисах, таких как Пекин, уровень загрязнения воздуха существенно изменяется во времени и зависит от сочетания множества факторов: метеорологических условий, сезонности, интенсивности промышленного производства и транспортных потоков. Для эффективного управления качеством воздуха крайне важно иметь точные и оперативные прогнозы концентрации PM2.5.

Цель данной работы — разработать и исследовать полносвязную нейронную сеть на базе фреймворка TensorFlow/Keras для прогноза концентрации PM2.5 на основе исторических данных и метеорологических показателей. В работе рассматривается обучающий пайплайн, архитектура модели, выбор гиперпараметров и сравнение нескольких алгоритмов оптимизации.

---

Глава 1. Обзор аналогичных решений

1.1. Классические статистические модели

Традиционные подходы к прогнозированию временных рядов качества воздуха опираются на:

- **ARIMA/ARIMAX модели** — авторегрессионные интегрированные модели со скользящим средним, учитывающие прошлые значения ряда и сезонность;
- **Линейную и полиномиальную регрессию**, в которых концентрация PM2.5 моделируется как линейная комбинация метеорологических признаков;
- **Экспоненциальное сглаживание** и аналогичные методы краткосрочного прогноза.

Эти модели хорошо работают при простых линейных зависимостях и небольшом количестве факторов, однако часто не справляются с ярко выраженной нелинейностью и сложными взаимодействиями между признаками (температура, влажность, скорость и направление ветра, уровни других загрязнителей).

1.2. Машинное обучение и ансамбли

В последние годы активно используются модели машинного обучения:

- Random Forest и Gradient Boosting** (например, XGBoost, LightGBM) — позволяют строить нелинейные зависимости и учитывают сложные взаимодействия признаков;
- SVM (Support Vector Regression)** — применяются для регрессии с ядровыми функциями;
- kNN-регрессия** — базовое решение на основе ближайших соседей.

Ансамблевые методы часто демонстрируют хорошее качество на табличных данных, однако требуют тщательной ручной настройки признаков и не всегда устойчивы к шуму и пропускам.

1.3. Нейронные сети для прогноза качества воздуха

Глубокие нейронные сети получили широкое распространение для задач:

- Прогнозирования временных рядов** (LSTM, GRU, 1D-CNN, гибридные CNN-LSTM);
- Многомерной регрессии** по большому количеству признаков (Dense сети);
- Пространственно-временного моделирования** (Graph Neural Networks, ConvLSTM).

В литературе встречаются работы, использующие LSTM/GRU для поминутного и почасового прогноза PM2.5, а также гибридные архитектуры, комбинирующие рекуррентные слои и свёртки.

В данной работе акцент делается на **полносвязной нейронной сети** как на относительно простой в реализации и интерпретации архитектуре, которая, тем не менее, способна выявлять сложные нелинейные зависимости в табличных данных.

---

Глава 2. Описание разработанной нейронной сети и экспериментальной постановки

2.1. Архитектура модели (слайды 3–4)

Разработанная модель представляет собой полносвязную нейронную сеть (Dense) c последовательной архитектурой:

- Входной слой принимает вектор признаков, сформированных из метеорологических и экологических данных, а также one-hot представления направления ветра.
- Три скрытых слоя содержат соответственно 256, 128 и 64 нейрона c функцией активации ReLU. После каждого слоя применяются BatchNormalization и Dropout (0.3 после первого, 0.2 после второго и третьего слоёв), что повышает устойчивость обучения и уменьшает переобучение.
- Выходной слой включает один нейрон с линейной активацией и возвращает прогноз концентрации PM2.5.

В качестве функции потерь используется MSE, а основной метрикой качества — MAE. Такие выборы типичны для задач регрессии и позволяют легко интерпретировать ошибку модели в физических единицах (µg/m³).

Обучение проводится батчами по 128 примеров, с максимальным числом эпох 120. За счёт EarlyStopping обучение автоматически останавливается при отсутствии улучшения валидационной ошибки.

2.2. Описание датасета (слайд 5)

Для обучения и тестирования нейросети используется набор данных **Beijing PM2.5 Dataset** из UCI Machine Learning Repository. Данные представляют собой почасовые наблюдения за период 2010–2014 гг. и включают:

- временные признаки (год, месяц, день, час);
- концентрации загрязняющих веществ (PM10, SO2, NO2, O3);
- метеорологические характеристики (температура, давление, точка росы, скорость и направление ветра).

Целевой переменной является концентрация PM2.5. Перед обучением выполняется очистка данных от пропусков и масштабирование признаков с помощью StandardScaler. Набор разбивается на обучающую, валидационную и тестовую выборки в пропорции 70/15/15.

2.3. Эксперименты с оптимизаторами и анализ кривых обучения (слайды 6–7)

Для оценки влияния алгоритма оптимизации обучаются пять вариантов модели с одинаковой архитектурой, но разными оптимизаторами:

1. Adam  
2. RMSprop  
3. SGD с momentum  
4. AdamW  
5. Nadam  

Для каждого оптимизатора сохраняются истории обучения: значения функции потерь (loss и val_loss) и средней абсолютной ошибки (mae и val_mae) по эпохам. На их основе строятся пары графиков:

- «Точность обучения и валидации» (1 − MAE для обучающей и валидационной выборки);  
- «Функция потерь обучения и валидации» (MSE по эпохам).

Кривые имеют гладкий, гиперболический/логарифмический характер и демонстрируют сходимость обучающих и валидационных значений, что свидетельствует о корректной настройке гиперпараметров. Итоговые значения MAE на тестовой выборке находятся в пределах 15–22 µg/m³ в зависимости от алгоритма оптимизации, а коэффициент детерминации R² достигает 0.75–0.85.

2.4. Демонстрация результатов и HTML‑интерфейс (слайд 6)

В процессе обучения генерируется интерактивная HTML‑страница (`pm25_app.html`), на которой отображаются:

- метрики лучшей модели на тестовой выборке (MAE, RMSE, R²);
- диаграмма «факт vs прогноз» для PM2.5;
- гистограмма остатков.

Эта страница может использоваться как демонстрационный интерфейс при защите проекта и как основа для будущего веб‑сервиса.

2.5. Дальнейшее развитие и репозиторий (слайд 8)

В завершение обсуждаются направления дальнейшей работы:

- расширение архитектуры до рекуррентных и свёрточных моделей, а также гибридных CNN‑LSTM;
- автоматический поиск гиперпараметров (Keras Tuner, Optuna);
- перенос модели в продакшн (REST API, мобильные приложения, интеграция с системами мониторинга качества воздуха).
